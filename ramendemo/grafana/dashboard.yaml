apiVersion: integreatly.org/v1alpha1
kind: GrafanaDashboard
metadata:
  labels:
    app: grafana
  name: ramendeno-nodes-dashboard
spec:
  json: |
    {
      "annotations": {
	"list": [
	  {
	    "builtIn": 1,
	    "datasource": "-- Grafana --",
	    "enable": true,
	    "hide": true,
	    "iconColor": "rgba(0, 211, 255, 1)",
	    "name": "Annotations & Alerts",
	    "type": "dashboard"
	  }
	]
      },
      "editable": true,
      "gnetId": null,
      "graphTooltip": 0,
      "id": 1,
      "links": [],
      "panels": [
	{
	  "datasource": null,
	  "description": "",
	  "fieldConfig": {
	    "defaults": {
	      "color": {
		"mode": "thresholds"
	      },
	      "displayName": "IO",
	      "mappings": [],
	      "max": 2000,
	      "min": 0,
	      "thresholds": {
		"mode": "absolute",
		"steps": [
		  {
		    "color": "green",
		    "value": null
		  },
		  {
		    "color": "yellow",
		    "value": 1500
		  },
		  {
		    "color": "red",
		    "value": 1700
		  }
		]
	      }
	    },
	    "overrides": []
	  },
	  "gridPos": {
	    "h": 9,
	    "w": 12,
	    "x": 0,
	    "y": 0
	  },
	  "id": 2,
	  "options": {
	    "reduceOptions": {
	      "calcs": [],
	      "fields": "",
	      "values": false
	    },
	    "showThresholdLabels": true,
	    "showThresholdMarkers": true,
	    "text": {}
	  },
	  "pluginVersion": "7.5.2",
	  "targets": [
	    {
	      "format": "time_series",
	      "group": [
		{
		  "params": [
		    "$__interval",
		    "0"
		  ],
		  "type": "time"
		}
	      ],
	      "metricColumn": "none",
	      "rawQuery": false,
	      "rawSql": "SELECT\n  $__timeGroupAlias(submit_time,$__interval,0),\n  count(id) AS \"id\"\nFROM ramendemo\nWHERE\n  $__timeFilter(submit_time) AND\n  isprimary = 1\nGROUP BY 1\nORDER BY $__timeGroup(submit_time,$__interval,0)",
	      "refId": "A",
	      "select": [
		[
		  {
		    "params": [
		      "id"
		    ],
		    "type": "column"
		  },
		  {
		    "params": [
		      "count"
		    ],
		    "type": "aggregate"
		  },
		  {
		    "params": [
		      "id"
		    ],
		    "type": "alias"
		  }
		]
	      ],
	      "table": "ramendemo",
	      "timeColumn": "submit_time",
	      "timeColumnType": "datetime",
	      "where": [
		{
		  "name": "$__timeFilter",
		  "params": [],
		  "type": "macro"
		},
		{
		  "datatype": "int",
		  "name": "",
		  "params": [
		    "isprimary",
		    "=",
		    "1"
		  ],
		  "type": "expression"
		}
	      ]
	    }
	  ],
	  "title": "Preferred Cluster",
	  "transparent": true,
	  "type": "gauge"
	},
	{
	  "datasource": null,
	  "description": "",
	  "fieldConfig": {
	    "defaults": {
	      "color": {
		"mode": "thresholds"
	      },
	      "displayName": "IO",
	      "mappings": [],
	      "max": 2000,
	      "min": 0,
	      "thresholds": {
		"mode": "absolute",
		"steps": [
		  {
		    "color": "green",
		    "value": null
		  },
		  {
		    "color": "yellow",
		    "value": 1500
		  },
		  {
		    "color": "red",
		    "value": 1700
		  }
		]
	      }
	    },
	    "overrides": []
	  },
	  "gridPos": {
	    "h": 9,
	    "w": 12,
	    "x": 12,
	    "y": 0
	  },
	  "id": 3,
	  "options": {
	    "reduceOptions": {
	      "calcs": [],
	      "fields": "",
	      "values": false
	    },
	    "showThresholdLabels": true,
	    "showThresholdMarkers": true,
	    "text": {}
	  },
	  "pluginVersion": "7.5.2",
	  "targets": [
	    {
	      "format": "time_series",
	      "group": [
		{
		  "params": [
		    "$__interval",
		    "0"
		  ],
		  "type": "time"
		}
	      ],
	      "metricColumn": "none",
	      "rawQuery": false,
	      "rawSql": "SELECT\n  $__timeGroupAlias(submit_time,$__interval,0),\n  count(id) AS \"id\"\nFROM ramendemo\nWHERE\n  $__timeFilter(submit_time) AND\n  isprimary = 0\nGROUP BY 1\nORDER BY $__timeGroup(submit_time,$__interval,0)",
	      "refId": "A",
	      "select": [
		[
		  {
		    "params": [
		      "id"
		    ],
		    "type": "column"
		  },
		  {
		    "params": [
		      "count"
		    ],
		    "type": "aggregate"
		  },
		  {
		    "params": [
		      "id"
		    ],
		    "type": "alias"
		  }
		]
	      ],
	      "table": "ramendemo",
	      "timeColumn": "submit_time",
	      "timeColumnType": "datetime",
	      "where": [
		{
		  "name": "$__timeFilter",
		  "params": [],
		  "type": "macro"
		},
		{
		  "datatype": "int",
		  "name": "",
		  "params": [
		    "isprimary",
		    "=",
		    "0"
		  ],
		  "type": "expression"
		}
	      ]
	    }
	  ],
	  "title": "Failover Cluster",
	  "transparent": true,
	  "type": "gauge"
	},
	{
	  "datasource": null,
	  "fieldConfig": {
	    "defaults": {
	      "color": {
		"mode": "thresholds"
	      },
	      "mappings": [],
	      "thresholds": {
		"mode": "absolute",
		"steps": [
		  {
		    "color": "green",
		    "value": null
		  }
		]
	      }
	    },
	    "overrides": []
	  },
	  "gridPos": {
	    "h": 3,
	    "w": 12,
	    "x": 0,
	    "y": 9
	  },
	  "id": 5,
	  "interval": null,
	  "options": {
	    "displayMode": "gradient",
	    "orientation": "horizontal",
	    "reduceOptions": {
	      "calcs": [
		"last"
	      ],
	      "fields": "",
	      "values": false
	    },
	    "showUnfilled": false,
	    "text": {
	      "valueSize": 0
	    }
	  },
	  "pluginVersion": "7.5.2",
	  "targets": [
	    {
	      "format": "time_series",
	      "group": [],
	      "metricColumn": "none",
	      "rawQuery": false,
	      "rawSql": "SELECT\n  submit_time AS \"time\",\n  cluster1\nFROM ramenfsid\nWHERE\n  $__timeFilter(submit_time)\nORDER BY submit_time",
	      "refId": "A",
	      "select": [
		[
		  {
		    "params": [
		      "cluster1"
		    ],
		    "type": "column"
		  }
		]
	      ],
	      "table": "ramenfsid",
	      "timeColumn": "submit_time",
	      "timeColumnType": "datetime",
	      "where": [
		{
		  "name": "$__timeFilter",
		  "params": [],
		  "type": "macro"
		}
	      ]
	    }
	  ],
	  "timeFrom": null,
	  "timeShift": null,
	  "title": "Preferred Active",
	  "transparent": true,
	  "type": "bargauge"
	},
	{
	  "datasource": null,
	  "fieldConfig": {
	    "defaults": {
	      "color": {
		"mode": "thresholds"
	      },
	      "mappings": [],
	      "thresholds": {
		"mode": "absolute",
		"steps": [
		  {
		    "color": "red",
		    "value": null
		  }
		]
	      }
	    },
	    "overrides": []
	  },
	  "gridPos": {
	    "h": 3,
	    "w": 12,
	    "x": 12,
	    "y": 9
	  },
	  "id": 6,
	  "interval": null,
	  "options": {
	    "displayMode": "gradient",
	    "orientation": "horizontal",
	    "reduceOptions": {
	      "calcs": [
		"last"
	      ],
	      "fields": "",
	      "values": false
	    },
	    "showUnfilled": false,
	    "text": {
	      "valueSize": 0
	    }
	  },
	  "pluginVersion": "7.5.2",
	  "targets": [
	    {
	      "format": "time_series",
	      "group": [],
	      "metricColumn": "none",
	      "rawQuery": false,
	      "rawSql": "SELECT\n  submit_time AS \"time\",\n  cluster2\nFROM ramenfsid\nWHERE\n  $__timeFilter(submit_time)\nORDER BY submit_time",
	      "refId": "A",
	      "select": [
		[
		  {
		    "params": [
		      "cluster2"
		    ],
		    "type": "column"
		  }
		]
	      ],
	      "table": "ramenfsid",
	      "timeColumn": "submit_time",
	      "timeColumnType": "datetime",
	      "where": [
		{
		  "name": "$__timeFilter",
		  "params": [],
		  "type": "macro"
		}
	      ]
	    }
	  ],
	  "timeFrom": null,
	  "timeShift": null,
	  "title": "Failover Active",
	  "transparent": true,
	  "type": "bargauge"
	},
	{
	  "datasource": null,
	  "fieldConfig": {
	    "defaults": {
	      "color": {
		"mode": "thresholds"
	      },
	      "mappings": [],
	      "thresholds": {
		"mode": "absolute",
		"steps": [
		  {
		    "color": "green",
		    "value": null
		  }
		]
	      }
	    },
	    "overrides": []
	  },
	  "gridPos": {
	    "h": 3,
	    "w": 12,
	    "x": 0,
	    "y": 12
	  },
	  "id": 8,
	  "interval": null,
	  "options": {
	    "colorMode": "value",
	    "graphMode": "area",
	    "justifyMode": "auto",
	    "orientation": "auto",
	    "reduceOptions": {
	      "calcs": [
		"lastNotNull"
	      ],
	      "fields": "/^metric$/",
	      "values": false
	    },
	    "text": {},
	    "textMode": "auto"
	  },
	  "pluginVersion": "7.5.2",
	  "targets": [
	    {
	      "format": "table",
	      "group": [
		{
		  "params": [
		    "$__interval",
		    "0"
		  ],
		  "type": "time"
		}
	      ],
	      "metricColumn": "gap",
	      "rawQuery": false,
	      "rawSql": "SELECT\n  $__timeGroupAlias(submit_time,$__interval,0),\n  gap AS metric,\n  cluster1\nFROM ramenfsid\nWHERE\n  $__timeFilter(submit_time) AND\n  prevdate != 0 AND\n  cluster1 = 1\nGROUP BY 1,2\nORDER BY $__timeGroup(submit_time,$__interval,0)",
	      "refId": "A",
	      "select": [
		[
		  {
		    "params": [
		      "cluster1"
		    ],
		    "type": "column"
		  }
		]
	      ],
	      "table": "ramenfsid",
	      "timeColumn": "submit_time",
	      "timeColumnType": "datetime",
	      "where": [
		{
		  "name": "$__timeFilter",
		  "params": [],
		  "type": "macro"
		},
		{
		  "datatype": "varchar",
		  "name": "",
		  "params": [
		    "prevdate",
		    "!=",
		    "0"
		  ],
		  "type": "expression"
		},
		{
		  "datatype": "int",
		  "name": "",
		  "params": [
		    "cluster1",
		    "=",
		    "1"
		  ],
		  "type": "expression"
		}
	      ]
	    }
	  ],
	  "timeFrom": null,
	  "timeShift": null,
	  "title": "Last Gap",
	  "transformations": [],
	  "transparent": true,
	  "type": "stat"
	},
	{
	  "datasource": null,
	  "fieldConfig": {
	    "defaults": {
	      "color": {
		"mode": "thresholds"
	      },
	      "mappings": [],
	      "thresholds": {
		"mode": "absolute",
		"steps": [
		  {
		    "color": "green",
		    "value": null
		  }
		]
	      }
	    },
	    "overrides": []
	  },
	  "gridPos": {
	    "h": 3,
	    "w": 12,
	    "x": 12,
	    "y": 12
	  },
	  "id": 9,
	  "interval": null,
	  "options": {
	    "colorMode": "value",
	    "graphMode": "area",
	    "justifyMode": "auto",
	    "orientation": "auto",
	    "reduceOptions": {
	      "calcs": [
		"lastNotNull"
	      ],
	      "fields": "/^metric$/",
	      "values": false
	    },
	    "text": {},
	    "textMode": "auto"
	  },
	  "pluginVersion": "7.5.2",
	  "targets": [
	    {
	      "format": "table",
	      "group": [
		{
		  "params": [
		    "$__interval",
		    "0"
		  ],
		  "type": "time"
		}
	      ],
	      "metricColumn": "gap",
	      "rawQuery": false,
	      "rawSql": "SELECT\n  $__timeGroupAlias(submit_time,$__interval,0),\n  gap AS metric,\n  cluster2\nFROM ramenfsid\nWHERE\n  $__timeFilter(submit_time) AND\n  prevdate != 0 AND\n  cluster2 = 1\nGROUP BY 1,2\nORDER BY $__timeGroup(submit_time,$__interval,0)",
	      "refId": "A",
	      "select": [
		[
		  {
		    "params": [
		      "cluster2"
		    ],
		    "type": "column"
		  }
		]
	      ],
	      "table": "ramenfsid",
	      "timeColumn": "submit_time",
	      "timeColumnType": "datetime",
	      "where": [
		{
		  "name": "$__timeFilter",
		  "params": [],
		  "type": "macro"
		},
		{
		  "datatype": "varchar",
		  "name": "",
		  "params": [
		    "prevdate",
		    "!=",
		    "0"
		  ],
		  "type": "expression"
		},
		{
		  "datatype": "int",
		  "name": "",
		  "params": [
		    "cluster2",
		    "=",
		    "1"
		  ],
		  "type": "expression"
		}
	      ]
	    }
	  ],
	  "timeFrom": null,
	  "timeShift": null,
	  "title": "Last Gap",
	  "transformations": [],
	  "transparent": true,
	  "type": "stat"
	}
      ],
      "refresh": "10s",
      "schemaVersion": 27,
      "style": "dark",
      "tags": [],
      "templating": {
	"list": []
      },
      "time": {
	"from": "now-15m",
	"to": "now"
      },
      "timezone": "",
      "title": "RamenDemo",
      "uid": "FoE9HChnz",
      "version": 15
    }
  name: ramendemo-dashboard.json
